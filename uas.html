<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Login + LocalStorage DB</title>

<style>
  body{font-family:Poppins,Arial;background:#eef2ff;padding:30px}
  .card{max-width:420px;margin:auto;background:white;padding:20px;border-radius:12px;box-shadow:0 10px 25px rgba(0,0,0,.1)}
  .field{margin:10px 0}
  input{width:100%;padding:10px;border-radius:8px;border:1px solid #ccc}
  button{width:100%;padding:10px;border:none;border-radius:8px;background:#6366f1;color:white;font-weight:600;margin-top:10px}
  .error{display:none;color:red;margin-top:6px}
  #userPage{display:none}
</style>
</head>

<body>

<div class="card" id="loginBox">
  <h3>Login</h3>

  <div class="error" id="errorMsg"></div>

  <div class="field">
    <input id="username" placeholder="username">
  </div>

  <div class="field">
    <input id="password" type="password" placeholder="password">
  </div>

  <button onclick="login()">Masuk</button>
</div>

<div class="card" id="userPage">
  <h3>Dashboard</h3>

  <p><b>Nama:</b> <span id="namaUser"></span></p>
  <p><b>Status:</b> Login berhasil ✔️</p>

  <button style="background:#ef4444" onclick="logout()">Logout</button>
</div>

<script>
/*
========================================
1) BUAT “DATABASE” DI LOCALSTORAGE
========================================
*/

if(!localStorage.getItem("usersDB")){
  const defaultUsers = [
    { username: "admin",   password: "12345" },
    { username: "siswa01", password: "abc123" },
    { username: "guru01",  password: "pbo2025" }
  ];

  localStorage.setItem("usersDB", JSON.stringify(defaultUsers));
  console.log("Database dibuat:", defaultUsers);
}

// ambil database
let USERS = JSON.parse(localStorage.getItem("usersDB"));

/*
========================================
2) LOGIN + AUTO LOGIN
========================================
*/

function showError(msg){
  const e=document.getElementById("errorMsg");
  e.style.display="block";
  e.textContent=msg;
}

function clearError(){
  document.getElementById("errorMsg").style.display="none";
}

function login(){
  clearError();
  const u=document.getElementById("username").value.trim();
  const p=document.getElementById("password").value.trim();

  const found = USERS.find(x=>x.username===u && x.password===p);

  if(found){
    localStorage.setItem("userLogin", JSON.stringify(found));

    document.getElementById("loginBox").style.display="none";
    document.getElementById("userPage").style.display="block";
    document.getElementById("namaUser").textContent=u;
  } else {
    showError("Username / password salah");
  }
}

function logout(){
  localStorage.removeItem("userLogin");

  document.getElementById("loginBox").style.display="block";
  document.getElementById("userPage").style.display="none";
}

/*
========================================
3) AUTO LOGIN TANPA INPUT
========================================
*/

const saved = localStorage.getItem("userLogin");

if(saved){
  const u = JSON.parse(saved);

  document.getElementById("loginBox").style.display="none";
  document.getElementById("userPage").style.display="block";
  document.getElementById("namaUser").textContent = u.username;
}
</script>

</body>
</html>
